apply plugin:'application'
mainClassName = 'com.twosigma.beaker.core.Main'

task (installBower, type: Exec) {
  commandLine 'npm', 'install'
}

task (bowerInstall, type: Exec) {
  commandLine './node_modules/bower/bin/bower', 'install'
}

task (copyNginx, type: Exec) {
  commandLine 'cp -f /usr/local/lib/libpcre.1.dylib /usr/local/bin/nginx /usr/local/etc/nginx/mime.types nginx/bin/nginx'.split()
}

bowerInstall.dependsOn installBower
build.dependsOn bowerInstall
run.dependsOn bowerInstall
run.dependsOn jar
run.dependsOn copyNginx

dependencies {
  compile project(':shared')
}

/* for testing
run {
  args '--disable-kerberos', '--default-notebook', 'config/default-test.bkr'
}
*/

// need to remove META-INF/*.SF to use this.
//build.dependsOn jar
//jar {
//  from configurations.compile.collect { it.isDirectory() ? it : zipTree(it) }
//}
